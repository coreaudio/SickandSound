<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Hausdienst Checkliste</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Orbitron-Font und euer zentrales Stylesheet -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Zus√§tzliche Feinjustierung f√ºr die Checkliste */
    body {
      padding: 20px;
      display: flex;
      flex-direction: column;
      height: 100%;
      background-color: #0f1117;
      color: #f1f1f1;
      font-family: 'Orbitron', sans-serif;
      margin: 0;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    .section {
      margin-bottom: 20px;
    }
    .section h2 {
      font-size: 1.1em;
      margin-bottom: 8px;
      border-bottom: 1px solid #2a2d34;
      padding-bottom: 4px;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    li {
      display: flex;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid #2a2d34;
      font-size: 0.95em;
    }
    li:last-child {
      border-bottom: none;
    }
    input[type="checkbox"] {
      margin-right: 12px;
      transform: scale(1.2);
      cursor: pointer;
    }
    .footer {
      margin-top: auto;
      text-align: center;
    }
    .footer .btn {
      margin: 0 8px;
    }
  </style>
</head>
<body>
  <h1>üè† Hausdienst Checkliste</h1>

  <div id="checklistContainer" style="flex-grow:1; overflow-y:auto;"></div>

  <div class="footer">
    <button class="btn reset" onclick="resetChecklist()">üîÑ Heute zur√ºcksetzen</button>
    <button class="btn" style="background:#444;color:#fff;" onclick="window.location='hausdienst.html'">üîô Zur Rangliste</button>
    <button class="btn" style="background:#444;color:#fff;" onclick="window.location='index.html'">üè† Zur√ºck zur Strichliste</button>
  </div>

  <script>
    const TASKS = {
      "Morgens": [
        "Briefkasten leeren",
        "Erste Runde Kaffee machen",
        "Sp√ºlmaschine aus-/einr√§umen",
        "M√ºll rausbringen",
        "Handt√ºcher wechseln",
        "Toilettenpapier auff√ºllen",
        "F√ºr Grundordnung sorgen"
      ],
      "Im Laufe des Tages": [
        "W√§sche anmachen & aufh√§ngen",
        "Pakete entgegennehmen"
      ],
      "Bevor man geht": [
        "Oberfl√§chen in der K√ºche wischen"
      ]
    };

    const STORAGE_KEY_DATE = "hausdienst_lastReset";
    const STORAGE_KEY_STATE = "hausdienst_checklist_state";

    function todayKey() {
      const d = new Date();
      return `${String(d.getDate()).padStart(2,'0')}.${String(d.getMonth()+1).padStart(2,'0')}.${d.getFullYear()}`;
    }

    function loadChecklist() {
      const lastReset = localStorage.getItem(STORAGE_KEY_DATE);
      const today     = todayKey();
      if (lastReset !== today) {
        // Neu zur√ºcksetzen
        localStorage.setItem(STORAGE_KEY_DATE, today);
        localStorage.setItem(STORAGE_KEY_STATE, JSON.stringify({}));
      }
      const state = JSON.parse(localStorage.getItem(STORAGE_KEY_STATE) || "{}");

      // HTML aufbauen
      let html = "";
      for (const [section, items] of Object.entries(TASKS)) {
        html += `<div class="section"><h2>${section}</h2><ul>`;
        items.forEach((task, i) => {
          const id = `${section}_${i}`;
          const checked = state[id] ? "checked" : "";
          html += `
            <li>
              <input type="checkbox" id="${id}" ${checked}
                     onchange="toggleTask('${id}')">
              <label for="${id}">${task}</label>
            </li>`;
        });
        html += `</ul></div>`;
      }
      document.getElementById("checklistContainer").innerHTML = html;
    }

    function toggleTask(id) {
      const state = JSON.parse(localStorage.getItem(STORAGE_KEY_STATE) || "{}");
      state[id] = !!document.getElementById(id).checked;
      localStorage.setItem(STORAGE_KEY_STATE, JSON.stringify(state));
    }

    function resetChecklist() {
      if (!confirm("Heute wirklich alles als unerledigt markieren?")) return;
      localStorage.setItem(STORAGE_KEY_STATE, JSON.stringify({}));
      loadChecklist();
    }

    // Initialisierung
    window.onload = loadChecklist;
  </script>
</body>
</html>
